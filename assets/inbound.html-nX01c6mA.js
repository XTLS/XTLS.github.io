import{_ as i,r as e,o as d,c as r,a as o,b as n,d as s,w as c,e as a}from"./app-Cd5-8a7D.js";const b={},k=n("h1",{id:"входящие-подключения",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#входящие-подключения"},[n("span",null,"Входящие подключения")])],-1),q=a(`<h2 id="inboundobject" tabindex="-1"><a class="header-anchor" href="#inboundobject"><span>InboundObject</span></a></h2><p><code>InboundObject</code> соответствует дочернему элементу поля <code>inbounds</code> в конфигурационном файле.</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;listen&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;название протокола&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;streamSettings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;тег&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sniffing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;destOverride&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tls&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;allocate&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;strategy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;refresh&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;concurrency&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>listen</code>: address</p></blockquote><p>Адрес прослушивания, IP-адрес или Unix domain socket.<br> Значение по умолчанию - <code>&quot;0.0.0.0&quot;</code>, что означает прием подключений на всех сетевых интерфейсах.</p><p>Можно указать любой доступный в системе IP-адрес.</p>`,6),m=n("code",null,'"/dev/shm/domain.socket"',-1),v=n("br",null,null,-1),g=n("code",null,"@",-1),f={href:"https://www.man7.org/linux/man-pages/man7/unix.7.html",target:"_blank",rel:"noopener noreferrer"},h=n("code",null,"@@",-1),y=a("<p>При указании Unix domain socket параметры <code>port</code> и <code>allocate</code> игнорируются.<br> В настоящее время поддерживаются протоколы VLESS, VMess, Trojan и типы транспорта TCP, WebSocket, HTTP/2, gRPC.</p><p>При указании Unix domain socket можно указать права доступа к сокету, добавив запятую и индикатор прав доступа, например <code>&quot;/dev/shm/domain.socket,0666&quot;</code>.<br> Это может помочь решить проблемы с правами доступа к сокету, которые возникают по умолчанию.</p><blockquote><p><code>port</code>: number | &quot;env:variable&quot; | string</p></blockquote><p>Порт.<br> Допустимые форматы:</p><ul><li>Целое число: фактический номер порта.</li><li>Переменная окружения: начинается с <code>&quot;env:&quot;</code>, за которым следует имя переменной окружения, например <code>&quot;env:PORT&quot;</code>.<br> Xray будет анализировать эту переменную окружения как строку.</li><li>Строка: может быть числом в виде строки, например <code>&quot;1234&quot;</code>, или диапазоном портов, например <code>&quot;5-10&quot;</code>, что означает порты с 5 по 10 (6 портов).<br> Можно использовать запятые для разделения диапазонов, например <code>11,13,15-17</code>, что означает порты 11, 13, 15, 16 и 17 (5 портов).</li></ul><p>Если указан только один порт, Xray будет прослушивать входящие подключения на этом порту.<br> Если указан диапазон портов, то фактическое поведение зависит от настройки <code>allocate</code>.</p><blockquote><p><code>protocol</code>: string</p></blockquote><p>Название протокола подключения.<br> Список доступных протоколов см. в разделе &quot;Входящие подключения&quot; в левой части документации.</p><blockquote><p><code>settings</code>: InboundConfigurationObject</p></blockquote><p>Конкретные настройки зависят от протокола.<br> См. описание <code>InboundConfigurationObject</code> для каждого протокола.</p>",10),_=n("code",null,"streamSettings",-1),j=a(`<p>Тип транспорта (transport) - это способ взаимодействия текущего узла Xray с другими узлами.</p><blockquote><p><code>tag</code>: string</p></blockquote><p>Тег этого входящего подключения, используемый для идентификации этого подключения в других настройках.</p><div class="custom-container danger"><p class="custom-container-title">Предупреждение</p><p>Если это поле не пустое, его значение должно быть <strong>уникальным</strong> среди всех тегов.</p></div><blockquote><p><code>sniffing</code>: <a href="#sniffingobject">SniffingObject</a></p></blockquote><p>Обнаружение трафика в основном используется для прозрачного проксирования и других целей.<br> Например, типичный сценарий выглядит следующим образом:</p><ol><li>Устройство пытается получить доступ к abc.com.<br> Сначала устройство выполняет DNS-запрос и получает IP-адрес 1.2.3.4 для abc.com.<br> Затем устройство пытается установить соединение с 1.2.3.4.</li><li>Если обнаружение трафика не настроено, Xray получает запрос на подключение к 1.2.3.4 и не может использовать доменные правила для маршрутизации и разделения трафика.</li><li>Если в sniffing включен параметр <code>enabled</code>, Xray при обработке трафика этого соединения попытается извлечь доменное имя из данных трафика, т.е. abc.com.</li><li>Xray заменит 1.2.3.4 на abc.com.<br> Маршрутизация сможет использовать доменные правила для разделения трафика.</li></ol><p>Так как запрос теперь направляется на abc.com, можно выполнять больше действий, например, повторное разрешение DNS, помимо разделения трафика по доменным правилам.</p><p>Если в sniffing включен параметр <code>enabled</code>, Xray также сможет обнаруживать трафик типа bittorrent, а затем можно настроить правила маршрутизации по протоколу, чтобы обрабатывать трафик BT, например, блокировать его на сервере или перенаправлять его на определенный VPS на клиенте.</p><blockquote><p><code>allocate</code>: <a href="#allocateobject">AllocateObject</a></p></blockquote><p>Настройки выделения портов при указании нескольких портов.</p><h3 id="sniffingobject" tabindex="-1"><a class="header-anchor" href="#sniffingobject"><span>SniffingObject</span></a></h3><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;destOverride&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tls&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fakedns&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadataOnly&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;domainsExcluded&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;routeOnly&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>enabled</code>: true | false</p></blockquote><p>Включить обнаружение трафика.</p><blockquote><p><code>destOverride</code>: [&quot;http&quot; | &quot;tls&quot; | &quot;quic&quot; | &quot;fakedns&quot; | &quot;fakedns+others&quot; ]</p></blockquote><p>Заменить целевой адрес текущего подключения на указанные типы, если трафик соответствует им.</p><p><code>[&quot;fakedns+others&quot;]</code> эквивалентно <code>[&quot;http&quot;, &quot;tls&quot;, &quot;quic&quot;, &quot;fakedns&quot;]</code>.<br> Если IP-адрес находится в диапазоне FakeIP, но не найдено соответствие доменному имени, будут использованы <code>http</code>, <code>tls</code> и <code>quic</code>.<br> Этот параметр действителен только при <code>metadataOnly</code> = <code>false</code>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Xray будет использовать доменные имена, обнаруженные с помощью sniffing, только для маршрутизации.<br> Если вы хотите только обнаруживать доменные имена для маршрутизации, но не хотите изменять целевой адрес (например, при использовании Tor Browser изменение целевого адреса может привести к невозможности подключения), добавьте соответствующие протоколы в этот список и включите <code>routeOnly</code>.</p></div><blockquote><p><code>metadataOnly</code>: true | false</p></blockquote><p>Если этот параметр включен, для обнаружения целевого адреса будут использоваться только метаданные подключения.<br> В этом случае все снифферы, кроме <code>fakedns</code>, будут отключены (включая <code>fakedns+others</code>).</p><p>Если этот параметр отключен, для определения целевого адреса будут использоваться не только метаданные, но и данные.<br> В этом случае клиенту необходимо сначала отправить данные, чтобы прокси-сервер установил соединение.<br> Это поведение несовместимо с протоколами, которые требуют, чтобы сервер первым отправил сообщение, например, SMTP.</p>`,22),x=n("code",null,"domainsExcluded",-1),O=a(`<p>Список доменных имен, для которых <strong>не будет</strong> выполняться замена целевого адреса, если они обнаружены с помощью sniffing.</p><p>Поддерживаются прямые доменные имена (точное совпадение) или регулярные выражения, начинающиеся с <code>regexp:</code>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Добавление некоторых доменных имен может решить проблемы с push-уведомлениями iOS, умными устройствами Mijia и голосовым чатом в некоторых играх (Rainbow Six Siege).<br> Если вам нужно выяснить причину каких-либо проблем, попробуйте отключить <code>&quot;sniffing&quot;</code> или включить <code>&quot;routeOnly&quot;</code>.</p></div><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token property">&quot;domainsExcluded&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;courier.push.apple.com&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Push-уведомления iOS</span>
    <span class="token string">&quot;Mijia Cloud&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Умные устройства Mijia</span>
    <span class="token string">&quot;dlg.io.mi.com&quot;</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Внимание</p><p>В настоящее время <code>domainsExcluded</code> не поддерживает способы сопоставления доменов, аналогичные тем, что используются в маршрутизации.<br> Этот параметр может быть изменен в будущем, совместимость между версиями не гарантируется.</p></div><blockquote><p><code>routeOnly</code>: true | false</p></blockquote><p>Использовать обнаруженные доменные имена только для маршрутизации.<br> Целевой адрес прокси-сервера остается IP-адресом.<br> Значение по умолчанию - <code>false</code>.</p><p>Этот параметр требует, чтобы <code>destOverride</code> был включен.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Если вы уверены, что <strong>проксируемое соединение будет правильно разрешено DNS</strong>, то при использовании <code>routeOnly</code> и включенном <code>destOverride</code> можно установить стратегию сопоставления маршрутов <code>domainStrategy</code> в <code>AsIs</code>, чтобы реализовать разделение трафика по доменам и IP-адресам без DNS-разрешения.<br> В этом случае при сопоставлении правил на основе IP-адресов будет использоваться исходный IP-адрес домена.</p></div><h3 id="allocateobject" tabindex="-1"><a class="header-anchor" href="#allocateobject"><span>AllocateObject</span></a></h3><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;strategy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;refresh&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;concurrency&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>strategy</code>: &quot;always&quot; | &quot;random&quot;</p></blockquote><p>Стратегия выделения портов.</p><ul><li><code>&quot;always&quot;</code> - всегда выделять все указанные порты.<br> Xray будет прослушивать все порты, указанные в <code>port</code>.</li><li><code>&quot;random&quot;</code> - случайным образом открывать порты.<br> Каждые <code>refresh</code> минут Xray будет случайным образом выбирать <code>concurrency</code> портов из диапазона, указанного в <code>port</code>, и прослушивать их.</li></ul><blockquote><p><code>refresh</code>: number</p></blockquote><p>Интервал обновления случайных портов в минутах.<br> Минимальное значение - <code>2</code>, рекомендуемое значение - <code>5</code>.<br> Этот параметр действителен только при <code>strategy</code> = <code>&quot;random&quot;</code>.</p><blockquote><p><code>concurrency</code>: number</p></blockquote><p>Количество случайных портов.<br> Минимальное значение - <code>1</code>, максимальное значение - треть от диапазона портов, указанного в <code>port</code>.<br> Рекомендуемое значение - <code>3</code>.</p>`,18);function S(I,P){const p=e("I18nTip"),t=e("RouterLink"),l=e("ExternalLinkIcon"),u=e("Badge");return d(),r("div",null,[o(p),k,n("p",null,[s("Входящие подключения используются для приема данных. Доступные протоколы см. в разделе "),o(t,{to:"/ru/config/inbounds/"},{default:c(()=>[s("Входящие протоколы")]),_:1}),s(".")]),q,n("p",null,[s("Поддерживается указание Unix domain socket в формате абсолютного пути, например "),m,s("."),v,s(" Можно добавить "),g,s(" в начало пути, чтобы использовать "),n("a",f,[s("абстрактный сокет"),o(l)]),s(", или "),h,s(", чтобы использовать абстрактный сокет с заполнением.")]),y,n("blockquote",null,[n("p",null,[_,s(": "),o(t,{to:"/ru/config/transport.html#streamsettingsobject"},{default:c(()=>[s("StreamSettingsObject")]),_:1})])]),j,n("blockquote",null,[n("p",null,[x,s(": [string] "),o(u,{text:"WIP",type:"warning"})])]),O])}const T=i(b,[["render",S],["__file","inbound.html.vue"]]);export{T as default};
