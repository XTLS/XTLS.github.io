import{_ as c,r as t,o as p,c as i,a as s,b as o,d as l,e}from"./app-Dvqlold4.js";const r={},d=e(`<h1 id="grpc" tabindex="-1"><a class="header-anchor" href="#grpc"><span>gRPC</span></a></h1><p>Режим передачи данных, основанный на HTTP/2, полностью соответствует стандарту HTTP/2 и может быть ретранслирован другими HTTP-серверами (такими как Nginx).</p><p>gRPC (HTTP/2) имеет встроенное мультиплексирование, не рекомендуется включать mux.cool при использовании gRPC и HTTP/2.</p><div class="custom-container warning"><p class="custom-container-title">⚠⚠⚠</p><ul><li>gRPC не поддерживает указание Host. Пожалуйста, укажите <strong>правильное доменное имя</strong> в адресе исходящего прокси или укажите <code>ServerName</code> в <code>(x)tlsSettings</code>, иначе подключение не будет установлено.</li><li>gRPC не поддерживает fallback на другие сервисы.</li><li>Существует риск активного сканирования сервисов gRPC. Рекомендуется использовать обратный прокси-сервер, такой как Caddy или Nginx, для предварительного разделения трафика по пути.</li></ul></div><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Если вы используете обратный прокси-сервер, такой как Caddy или Nginx, обратите внимание на следующие моменты:</p><ul><li>Убедитесь, что на обратном прокси-сервере включен HTTP/2.</li><li>Используйте HTTP/2 или h2c (Caddy), grpc_pass (Nginx) для подключения к Xray.</li><li>Путь в обычном режиме: <code>/\${serviceName}/Tun</code>, в режиме Multi: <code>/\${serviceName}/TunMulti</code>.</li><li>Если необходимо получать IP-адрес клиента, его можно передать через заголовок <code>X-Real-IP</code>, отправленный Caddy / Nginx.</li></ul></div><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Если вы используете fallback, обратите внимание на следующие моменты:</p><ul><li>Не рекомендуется использовать fallback на gRPC, так как существует риск активного сканирования.</li><li>Убедитесь, что <code>h2</code> находится на первом месте в (x)tlsSettings.alpn, иначе gRPC (HTTP/2) может не завершить TLS-рукопожатие.</li><li>gRPC не поддерживает маршрутизацию на основе path с помощью Xray.</li></ul></div><h2 id="grpcobject" tabindex="-1"><a class="header-anchor" href="#grpcobject"><span>GRPCObject</span></a></h2><p><code>GRPCObject</code> соответствует элементу <code>grpcSettings</code> конфигурации передачи.</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;authority&quot;</span><span class="token operator">:</span> <span class="token string">&quot;grpc.example.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;serviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;multiMode&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;user_agent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom user agent&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;idle_timeout&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
  <span class="token property">&quot;health_check_timeout&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;permit_without_stream&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;initial_windows_size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>authority</code>: string</p></blockquote><p>Строка, которая может использоваться как Host для реализации некоторых других целей.</p><blockquote><p><code>serviceName</code>: string</p></blockquote><p>Строка, указывающая имя сервиса, <strong>аналогично</strong> пути в HTTP/2. Клиент будет использовать это имя для связи, а сервер будет проверять, совпадает ли имя сервиса.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Когда <code>serviceName</code> начинается с косой черты, можно настроить собственный путь, используя как минимум две косые черты.<br> Например, если на сервере указано <code>&quot;serviceName&quot;: &quot;/my/sample/path1|path2&quot;</code>, то на клиенте можно указать <code>&quot;serviceName&quot;: &quot;/my/sample/path1&quot;</code> или <code>&quot;/my/sample/path2&quot;</code>.</p></div><blockquote><p><code>user_agent</code>: string</p></blockquote><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p><strong>Необходимо настроить только</strong> в <code>outbound</code> <strong>(клиент)</strong>.</p></div><p>Установка пользовательского агента gRPC, может предотвратить блокировку трафика gRPC некоторыми CDN.</p>`,17),u=o("code",null,"multiMode",-1),m=e('<p><code>true</code> включает <code>multiMode</code>, значение по умолчанию: <code>false</code>.</p><p>Это <strong>экспериментальная</strong> опция, которая может быть удалена в будущем, и ее совместимость между версиями не гарантируется. Этот режим может обеспечить прирост производительности примерно на 20% <strong>в тестовой среде</strong>, фактическая производительность зависит от скорости передачи.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p><strong>Необходимо настроить только</strong> в <code>outbound</code> <strong>(клиент)</strong>.</p></div><blockquote><p><code>idle_timeout</code>: number</p></blockquote><p>Проверка работоспособности выполняется, если в течение определенного периода времени, измеряемого в секундах, не происходит передача данных. Если это значение меньше <code>10</code>, то в качестве минимального значения будет использоваться <code>10</code>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Если не используется обратный прокси-сервер, такой как Caddy или Nginx (<strong>обычно не используется</strong>), и это значение установлено меньше <code>60</code>, сервер может отправить непредвиденный кадр h2 GOAWAY, чтобы закрыть существующее соединение.</p></div><p>По умолчанию проверка работоспособности <strong>отключена</strong>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p><strong>Необходимо настроить только</strong> в <code>outbound</code> <strong>(клиент)</strong>.</p></div><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Может решить некоторые проблемы с &quot;обрывом&quot; соединения.</p></div><blockquote><p><code>health_check_timeout</code>: number</p></blockquote><p>Время ожидания ответа проверки работоспособности в секундах. Если в течение этого времени проверка работоспособности не будет завершена и по-прежнему не будет передачи данных, проверка работоспособности будет считаться неудачной. Значение по умолчанию: <code>20</code>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>Настройка требуется <strong>только</strong> на стороне <strong>исходящего соединения</strong> (<strong>клиента</strong>).</p></div><blockquote><p><code>permit_without_stream</code>: true | false</p></blockquote><p><code>true</code> разрешает проверку работоспособности, если нет дочерних подключений. Значение по умолчанию: <code>false</code>.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p><strong>Необходимо настроить только</strong> в <code>outbound</code> <strong>(клиент)</strong>.</p></div><blockquote><p><code>initial_windows_size</code>: number</p></blockquote><p>Начальный размер окна h2 Stream. Если значение меньше или равно <code>0</code>, эта функция не действует. Если значение больше <code>65535</code>, механизм динамического окна будет отключен. Значение по умолчанию: <code>0</code>, то есть не действует.</p><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p><strong>Необходимо настроить только</strong> в <code>outbound</code> <strong>(клиент)</strong>.</p></div><div class="custom-container tip"><p class="custom-container-title">Подсказка</p><p>При использовании CDN Cloudflare можно установить значение <code>65536</code> или выше, чтобы отключить механизм динамического окна, что предотвратит отправку непредвиденных кадров h2 GOAWAY CDN Cloudflare для закрытия существующего соединения.</p></div>',19);function g(v,k){const n=t("I18nTip"),a=t("Badge");return p(),i("div",null,[s(n),d,o("blockquote",null,[o("p",null,[u,l(": true | false "),s(a,{text:"BETA",type:"warning"})])]),m])}const q=c(r,[["render",g],["__file","grpc.html.vue"]]);export{q as default};
